import{d as B,r as n,B as k,K as V,e as z,f as Y,h as a,w as r,J as H,j as u,o as $,m as y,x as g,_ as P}from"./index-CS97xECk.js";import{a as I}from"./fault-4m_H0PCC.js";import{l as U,P as Z}from"./lodash-Cu6ATtqO.js";import"./index-Bwm8AFsF.js";const j={class:"layout_container"},q=B({__name:"index",setup(J){const f=n(!1),v=n(""),c=n(),s=n(),N=n([]),F=n(1),b=n(10),L=n(0),M=n([]),T=n({}),i=async()=>{const t=H.get("Token");try{const o=c.value||"",d=s.value||"",m=await I({deviceType:"-1",faultFlag:"2",warningDataType:"1",mlineid:"",netMlineid:"",startTime:o,endTime:d,pageSize:b.value.toString(),page:F.value.toString(),token:t});if(Number(m.Code)===1){const _=JSON.parse(m.Message);N.value=_.map(e=>({FaultTime:`${e.FaultTime.replace("T"," ")} ${e.FaultTimeMS}`,FaultLine:`${e.FMLName}`,NetMLName:e.NetMLName,FLineVolevel:e.FLineVolevel,FaultPole:e.FElepoName,FaultNature:e.FaultNature,FaultType:e.FaultType,SMLName:e.SMLName,SElepoName:e.SElepoName,EMLName:e.EMLName,EElepoName:e.EElepoName,FaultDistance:e.FaultDistance,FaultDirection:e.FaultDirection,FaultSection:e.FaultSection,FaultSLType:e.FaultSLType,CHZFlag:e.CHZFlag,FEleoffName:e.FEleoffName||"无",hiddendanger:e.NetMLName?`${e.FMLName} ${e.FElepoName}`:e.FElepoName,line:e.NetMLName?e.FMLName:e.FElepoName,FMLName:`${e.FMLName}`,DurationTime:e.DurationTime,FaultID:e.FaultID,FaultDescription:""})),L.value=_.length>0?_[0].Total:0}else N.value=[],L.value=0}catch(o){console.error("获取故障信息失败:",o)}},D=t=>{F.value=t,i()},E=t=>{T.value=t,f.value=!0},S=t=>{b.value=t,F.value=1,i()};k(M,(t,o)=>{if(c.value=t?t[0]:"",s.value=t?t[1]:"",s.value&&c.value&&s.value<c.value){const d=s.value;s.value=c.value,c.value=d}i()},{immediate:!0}),V(i);const h=U.debounce(i,300);return k(v,()=>{h()},{immediate:!0}),(t,o)=>{const d=u("el-input"),m=u("el-form-item"),_=u("el-date-picker"),e=u("el-button"),C=u("el-form"),l=u("el-table-column"),x=u("el-table"),w=u("el-pagination");return $(),z("div",j,[Y("div",null,[a(C,{inline:!0,class:"form"},{default:r(()=>[a(m,null,{default:r(()=>[a(d,{placeholder:"输入关键字",modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=p=>v.value=p)},null,8,["modelValue"])]),_:1}),a(m,null,{default:r(()=>[a(_,{modelValue:M.value,"onUpdate:modelValue":o[1]||(o[1]=p=>M.value=p),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss","default-time":new Date},null,8,["modelValue","default-time"])]),_:1}),a(m,null,{default:r(()=>[a(e,{type:"primary",size:"default",disabled:!v.value,onClick:i},{default:r(()=>[y(" 搜索 ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),a(x,{data:N.value},{default:r(()=>[a(l,{label:"告警时间",align:"center",prop:"FaultTime",width:"200px"}),a(l,{label:"告警线路",align:"center",prop:"FaultLine",width:"100px"}),a(l,{label:"告警复杂线路",align:"center",prop:"NetMLName",width:"100px"}),a(l,{label:"告警线路电压等级kv",align:"center",prop:"FLineVolevel",width:"100px"}),a(l,{label:"告警杆塔",align:"center",prop:"FaultPole"}),a(l,{label:"告警起始线路",align:"center",prop:"SMLName"}),a(l,{label:"告警起始杆塔",align:"center",prop:"SElepoName"}),a(l,{label:"告警终止线路",align:"center",prop:"EMLName"}),a(l,{label:"告警终止杆塔",align:"center",prop:"EElepoName"}),a(l,{label:"告警方向",align:"center",prop:"FaultDirection"}),a(l,{label:"告警区间",align:"center",prop:"FaultSection"}),a(l,{label:"距离",align:"center",prop:"FaultDistance"}),a(l,{label:"告警相别",align:"center",prop:"FaultSLType"}),a(l,{label:"告警性质",align:"center",prop:"FaultNature"}),a(l,{label:"告警类型",align:"center",prop:"FaultType"}),a(l,{label:"重合闸状态",align:"center",prop:"CHZFlag"}),a(l,{label:"所属局",align:"center",prop:"FEleoffName"}),g("",!0),g("",!0),g("",!0),g("",!0),a(l,{label:"操作",align:"center",width:"100px"},{default:r(({row:p})=>[a(e,{type:"primary",onClick:G=>E(p)},{default:r(()=>[y("预览")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(Z,{selectedFault:T.value,visible:f.value,"onUpdate:visible":o[2]||(o[2]=p=>f.value=p)},null,8,["selectedFault","visible"]),a(w,{"current-page":F.value,"page-size":b.value,"page-sizes":[10,20,30,50],background:!0,layout:"prev, pager, next, jumper, ->, sizes, total",total:L.value,onCurrentChange:D,onSizeChange:S,"default-value":new Date,"pager-count":3},null,8,["current-page","page-size","total","default-value"])])}}}),Q=P(q,[["__scopeId","data-v-d59a83de"]]);export{Q as default};
